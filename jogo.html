// ======== CUPOM DE DESCONTO ========
function aplicarDesconto(codigo, porcentagem) {
  localStorage.setItem("cupom", JSON.stringify({ codigo, porcentagem }));
}
function obterCupom() {
  const cupom = localStorage.getItem("cupom");
  return cupom ? JSON.parse(cupom) : null;
}
window.aplicarDesconto = aplicarDesconto;
window.obterCupom = obterCupom;

// ======== EXEMPLO CARRINHO (opcional) ========
function adicionarAoCarrinho(produto) {
  const carrinho = JSON.parse(localStorage.getItem("carrinho") || "[]");
  carrinho.push(produto);
  localStorage.setItem("carrinho", JSON.stringify(carrinho));
  alert(${produto.nome} foi adicionado ao carrinho!);
}
window.adicionarAoCarrinho = adicionarAoCarrinho;

// =======================
// CUPOM DE DESCONTO
// =======================

// Valor fixo do desconto (por exemplo, 10%)
const DESCONTO = 0.1;

// Nome do cupom v√°lido
const CUPOM_VALIDO = "MEGADIA10";

// Elementos da p√°gina
const botaoCupom = document.getElementById("aplicar-cupom");
const campoCupom = document.getElementById("campo-cupom");
const msgCupom = document.getElementById("mensagem-cupom");
const totalElem = document.getElementById("total");

// Fun√ß√£o para pegar data atual (sem hora)
function dataHoje() {
  const hoje = new Date();
  return hoje.toISOString().split("T")[0]; // Exemplo: "2025-10-26"
}

// Fun√ß√£o para salvar data do √∫ltimo uso
function salvarUsoCupom() {
  localStorage.setItem("cupomUsadoHoje", dataHoje());
}

// Verifica se j√° usou o cupom hoje
function jaUsouCupomHoje() {
  const ultimoUso = localStorage.getItem("cupomUsadoHoje");
  return ultimoUso === dataHoje();
}

// Fun√ß√£o para aplicar o desconto
function aplicarDesconto() {
  const totalTexto = totalElem.textContent.replace("Total: R$", "").trim();
  const total = parseFloat(totalTexto);

  const novoTotal = total - total * DESCONTO;
  totalElem.textContent = Total: R$ ${novoTotal.toFixed(2)} (com desconto üéâ);
}

// Clique no bot√£o
if (botaoCupom) {
  botaoCupom.addEventListener("click", () => {
    const codigo = campoCupom.value.trim();

    if (jaUsouCupomHoje()) {
      msgCupom.textContent = "‚ö†Ô∏è Voc√™ j√° usou um cupom hoje. Tente novamente amanh√£.";
      msgCupom.style.color = "orange";
      return;
    }

    if (codigo === CUPOM_VALIDO) {
      aplicarDesconto();
      salvarUsoCupom();
      msgCupom.textContent = "‚úÖ Cupom aplicado com sucesso!";
      msgCupom.style.color = "green";
    } else {
      msgCupom.textContent = "‚ùå Cupom inv√°lido!";
      msgCupom.style.color = "red";
    }
  });
}
<script>
// ======== CUPOM DE DESCONTO DO JOGO ========

// Fun√ß√£o para aplicar o desconto, se existir
function aplicarCupom() {
  const cupomSalvo = JSON.parse(localStorage.getItem("cupomMemoria"));

  if (!cupomSalvo) return; // Nenhum cupom salvo

  const agora = Date.now();

  // Verifica validade (24h)
  if (agora > cupomSalvo.expira) {
    localStorage.removeItem("cupomMemoria");
    return;
  }

  // Seleciona elementos do carrinho
  const totalEl = document.getElementById("total");
  const lista = document.getElementById("lista-carrinho");

  // Pega o valor total (exemplo: "Total: R$ 199,00")
  const texto = totalEl.textContent || "";
  const numero = parseFloat(texto.replace(/[^\d,]/g, "").replace(",", "."));

  if (isNaN(numero)) return;

  const desconto = cupomSalvo.valor;
  const novoTotal = numero - (numero * desconto / 100);

  // Mostra cupom e total atualizado
  const infoCupom = document.createElement("p");
  infoCupom.innerHTML = `
    üéâ Cupom aplicado: <strong>${cupomSalvo.codigo}</strong> (${desconto}% off)<br>
    Novo total: <strong>R$ ${novoTotal.toFixed(2).replace(".", ",")}</strong>
  `; {
  infoCupom.style.color = "#008000";
  infoCupom.style.fontWeight = "bold";
  infoCupom.style.marginTop = "10px";

  lista.insertAdjacentElement("afterend", infoCupom);
  totalEl.textContent = Total: R$ ${novoTotal.toFixed(2).replace(".", ",")};
}

// Executa quando a p√°gina carrega
window.addEventListener("DOMContentLoaded", aplicarCupom);
</script>
